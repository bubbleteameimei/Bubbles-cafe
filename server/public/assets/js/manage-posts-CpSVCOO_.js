import{j as e}from"./ui-XowJfzQ7.js";import{u as s,r as a}from"./router-ft_y90OU.js";import{q as t,a as l,b as i,c as r,d as n,B as c,G as d,C as o,e as h,f as x,R as m,h as u,l as j,aM as p,N as g,O as f,P as N,r as v,I as b,ay as w,az as y,aA as C,aB as k,aC as A,E as S,K as P,a1 as T,aH as F,b6 as O,bl as E,M as L,D as $,s as R,t as H,v as I,y as D,w as z,m as U,bd as G,be as V,bf as M,bg as q,bh as B,i as W,T as Y,bi as K,a9 as Q,ab as _,ac as J,ad as X,ae as Z,af as ee,ag as se,ah as ae}from"./index-CaZ-hcXF.js";import{C as te}from"./checkbox-CZs5qr2K.js";import{T as le,b as ie,c as re,d as ne,e as ce,f as de}from"./table-CIMJ6G5B.js";import{P as oe}from"./pencil-RjeK00tF.js";import{F as he}from"./filter-CwI5yzYg.js";import{B as xe,E as me}from"./ellipsis-D5TV-uL7.js";import{C as ue}from"./chart-no-axes-column-increasing-BTCwDtP-.js";import{a as je}from"./utils-SDRWPbZe.js";import"./vendor-BbHwBAXo.js";import"./charts-DEf8bB7g.js";import"./animations-yM4Nun4l.js";import"./forms-BLyiBPJV.js";const pe=t("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);function ge(){const[t,ge]=s(),{toast:fe}=l(),Ne=i(),[ve,be]=a.useState(""),[we,ye]=a.useState("all"),[Ce,ke]=a.useState("all"),[Ae,Se]=a.useState("all"),[Pe,Te]=a.useState([]),[Fe,Oe]=a.useState(!1),[Ee,Le]=a.useState(null),[$e,Re]=a.useState(!1),[He,Ie]=a.useState({title:"",status:"published",featured:!1,triggerWarnings:"",themeCategory:""}),{data:De,isLoading:ze,isError:Ue,error:Ge}=r({queryKey:["admin/posts",Ae,we,Ce,ve],queryFn:async()=>{const e=new URLSearchParams;"all"!==we&&e.append("status",we),"all"!==Ce&&e.append("category",Ce),ve&&e.append("search",ve);let s="/api/admin/posts";"flagged"===Ae?s="/api/admin/posts/flagged":"pending"===Ae?s="/api/admin/posts/pending":"featured"===Ae&&e.append("featured","true");const a=await fetch(`${s}?${e.toString()}`);if(!a.ok)throw new Error("Failed to fetch posts");return a.json()}}),Ve=n({mutationFn:async e=>{const s=await fetch(`/api/admin/posts/${e}`,{method:"DELETE"});if(!s.ok)throw new Error("Failed to delete post");return s.json()},onSuccess:()=>{Ne.invalidateQueries({queryKey:["admin/posts"]}),fe({title:"Post Deleted",description:"The post has been successfully deleted."}),Oe(!1)},onError:e=>{fe({title:"Error",description:e.message||"Failed to delete post",variant:"destructive"})}}),Me=n({mutationFn:async({id:e,data:s})=>{const a=await fetch(`/api/admin/posts/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw new Error("Failed to update post");return a.json()},onSuccess:()=>{Ne.invalidateQueries({queryKey:["admin/posts"]}),fe({title:"Post Updated",description:"The post has been successfully updated."}),Re(!1)},onError:e=>{fe({title:"Error",description:e.message||"Failed to update post",variant:"destructive"})}}),qe=n({mutationFn:async({action:e,postIds:s})=>{const a=await fetch("/api/admin/posts/bulk",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:e,postIds:s})});if(!a.ok)throw new Error(`Failed to ${e} posts`);return a.json()},onSuccess:(e,s)=>{Ne.invalidateQueries({queryKey:["admin/posts"]});let a="";switch(s.action){case"publish":a="published";break;case"unpublish":a="unpublished";break;case"delete":a="deleted";break;case"feature":a="featured";break;case"unfeature":a="unfeatured";break;default:a="processed"}fe({title:"Bulk Action Complete",description:`${s.postIds.length} posts have been ${a}.`}),Te([])},onError:e=>{fe({title:"Error",description:e.message||"Failed to process bulk action",variant:"destructive"})}}),Be=n({mutationFn:async({id:e,publish:s})=>{const a=await fetch(`/api/admin/posts/${e}/${s?"publish":"unpublish"}`,{method:"PATCH"});if(!a.ok)throw new Error(`Failed to ${s?"publish":"unpublish"} post`);return a.json()},onSuccess:(e,s)=>{Ne.invalidateQueries({queryKey:["admin/posts"]}),fe({title:s.publish?"Post Published":"Post Unpublished",description:s.publish?"The post is now visible to users.":"The post has been unpublished and is no longer visible to users."})},onError:e=>{fe({title:"Error",description:e.message||"Failed to change post status",variant:"destructive"})}}),We=n({mutationFn:async({id:e,feature:s})=>{const a=await fetch(`/api/admin/posts/${e}/${s?"feature":"unfeature"}`,{method:"PATCH"});if(!a.ok)throw new Error(`Failed to ${s?"feature":"unfeature"} post`);return a.json()},onSuccess:(e,s)=>{Ne.invalidateQueries({queryKey:["admin/posts"]}),fe({title:s.feature?"Post Featured":"Post Unfeatured",description:s.feature?"The post is now featured on the homepage.":"The post has been removed from featured content."})},onError:e=>{fe({title:"Error",description:e.message||"Failed to change feature status",variant:"destructive"})}}),Ye=e=>{Be.mutate({id:e.id,publish:!e.published})},Ke=e=>{Le(e),Oe(!0)},Qe=e=>{Le(e);const s=e.metadata;Ie({title:e.title,status:e.published?"published":"draft",featured:e.featured||!1,themeCategory:s?.themeCategory||"",triggerWarnings:s?.triggerWarnings?.join(", ")||""}),Re(!0)},_e=e=>{Te(e&&De?.posts?De.posts.map(e=>e.id):[])},Je=(e,s)=>{Te(e?[...Pe,s]:Pe.filter(e=>e!==s))},Xe=e=>{0!==Pe.length?qe.mutate({action:e,postIds:Pe}):fe({title:"No Posts Selected",description:"Please select at least one post to perform this action.",variant:"default"})},Ze=De?.posts||[],es=De?.total||0,ss=Ze.length>0&&Pe.length===Ze.length,as=Pe.length>0&&Pe.length<Ze.length,ts=De?.stats?.pending||0,ls=De?.stats?.flagged||0,is=s=>s.flagged?e.jsxs(U,{variant:"destructive",className:"gap-1",children:[e.jsx(d,{className:"h-3 w-3"}),"Flagged"]}):s.published?s.featured?e.jsxs(U,{className:"bg-amber-600 gap-1",children:[e.jsx(S,{className:"h-3 w-3"}),"Featured"]}):e.jsxs(U,{variant:"default",className:"gap-1",children:[e.jsx(m,{className:"h-3 w-3"}),"Published"]}):e.jsxs(U,{variant:"outline",className:"gap-1",children:[e.jsx(j,{className:"h-3 w-3"}),"Draft"]}),rs=s=>{const a=s.metadata;if(!a?.themeCategory)return null;const t=a.themeCategory;let l="bg-gray-100 text-gray-800 border-gray-300";switch(t){case"PSYCHOLOGICAL":l="bg-purple-100 text-purple-800 border-purple-300";break;case"SUPERNATURAL":l="bg-indigo-100 text-indigo-800 border-indigo-300";break;case"TECHNOLOGICAL":l="bg-blue-100 text-blue-800 border-blue-300";break;case"BODY_HORROR":l="bg-red-100 text-red-800 border-red-300";break;case"GOTHIC":l="bg-slate-100 text-slate-800 border-slate-300";break;case"APOCALYPTIC":l="bg-amber-100 text-amber-800 border-amber-300"}return e.jsx(U,{variant:"outline",className:l,children:t.replace("_"," ")})},ns=e=>e?je(new Date(e),"MMM d, yyyy"):"Unknown";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Manage Posts"}),e.jsx("p",{className:"text-muted-foreground",children:"View, edit, and manage all posts across the platform."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(c,{onClick:()=>ge("/admin/content-moderation"),variant:"outline",size:"sm",children:[e.jsx(d,{className:"h-4 w-4 mr-2"}),"Content Moderation"]}),e.jsxs(c,{onClick:()=>ge("/submit-story"),size:"sm",children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"New Post"]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(o,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Total Posts"}),e.jsx(m,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(u,{children:[e.jsx("div",{className:"text-2xl font-bold",children:es}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[De?.stats?.published||0," published"]})]})]}),e.jsxs(o,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Pending Review"}),e.jsx(j,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(u,{children:[e.jsx("div",{className:"text-2xl font-bold",children:ts}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting moderation"})]})]}),e.jsxs(o,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Flagged Content"}),e.jsx(p,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(u,{children:[e.jsx("div",{className:"text-2xl font-bold",children:ls}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Reported by users"})]})]})]}),e.jsxs(g,{defaultValue:"all",value:Ae,onValueChange:Se,children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[e.jsxs(f,{children:[e.jsx(N,{value:"all",children:"All Posts"}),e.jsx(N,{value:"featured",children:"Featured"}),e.jsxs(N,{value:"pending",className:"relative",children:["Pending",ts>0&&e.jsx("span",{className:"absolute -top-1 -right-1 flex h-4 w-4 items-center justify-center rounded-full bg-primary text-[10px] text-primary-foreground",children:ts})]}),e.jsxs(N,{value:"flagged",className:"relative",children:["Flagged",ls>0&&e.jsx("span",{className:"absolute -top-1 -right-1 flex h-4 w-4 items-center justify-center rounded-full bg-destructive text-[10px] text-destructive-foreground",children:ls})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("form",{onSubmit:e=>{e.preventDefault()},className:"relative",children:[e.jsx(v,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(b,{type:"search",placeholder:"Search posts...",className:"pl-8 w-full sm:w-[200px] lg:w-[300px]",value:ve,onChange:e=>be(e.target.value)})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(w,{value:we,onValueChange:ye,children:[e.jsxs(y,{className:"w-[130px]",children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),e.jsx(C,{placeholder:"Status"})]}),e.jsxs(k,{children:[e.jsx(A,{value:"all",children:"All Statuses"}),e.jsx(A,{value:"published",children:"Published"}),e.jsx(A,{value:"draft",children:"Draft"}),e.jsx(A,{value:"flagged",children:"Flagged"})]})]}),e.jsxs(w,{value:Ce,onValueChange:ke,children:[e.jsxs(y,{className:"w-[140px]",children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),e.jsx(C,{placeholder:"Category"})]}),e.jsxs(k,{children:[e.jsx(A,{value:"all",children:"All Categories"}),e.jsx(A,{value:"PSYCHOLOGICAL",children:"Psychological"}),e.jsx(A,{value:"SUPERNATURAL",children:"Supernatural"}),e.jsx(A,{value:"TECHNOLOGICAL",children:"Technological"}),e.jsx(A,{value:"BODY_HORROR",children:"Body Horror"}),e.jsx(A,{value:"GOTHIC",children:"Gothic"}),e.jsx(A,{value:"APOCALYPTIC",children:"Apocalyptic"})]})]})]})]})]}),Pe.length>0&&e.jsxs("div",{className:"bg-muted p-3 rounded-md mb-4 flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm",children:[Pe.length," ",1===Pe.length?"post":"posts"," selected"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{size:"sm",variant:"outline",onClick:()=>Xe("publish"),children:[e.jsx(m,{className:"h-4 w-4 mr-1"}),"Publish"]}),e.jsxs(c,{size:"sm",variant:"outline",onClick:()=>Xe("unpublish"),children:[e.jsx(xe,{className:"h-4 w-4 mr-1"}),"Unpublish"]}),e.jsxs(c,{size:"sm",variant:"outline",onClick:()=>Xe("feature"),children:[e.jsx(S,{className:"h-4 w-4 mr-1"}),"Feature"]}),e.jsxs(c,{size:"sm",variant:"destructive",onClick:()=>Xe("delete"),children:[e.jsx(P,{className:"h-4 w-4 mr-1"}),"Delete"]})]})]}),e.jsx(T,{value:"all",className:"space-y-4",children:e.jsx(o,{children:e.jsx(u,{className:"p-0",children:ze?e.jsx("div",{className:"flex justify-center items-center h-60",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading posts..."})}):Ue?e.jsxs("div",{className:"flex justify-center items-center h-60 flex-col gap-2",children:[e.jsx(F,{className:"h-8 w-8 text-destructive"}),e.jsx("p",{className:"text-destructive",children:Ge instanceof Error?Ge.message:"Failed to load posts"})]}):0===Ze.length?e.jsx("div",{className:"flex justify-center items-center h-60 flex-col gap-2",children:e.jsx("p",{className:"text-muted-foreground",children:"No posts found matching your criteria."})}):e.jsx("div",{className:"relative overflow-x-auto",children:e.jsxs(le,{children:[e.jsx(ie,{children:e.jsxs(re,{children:[e.jsx(ne,{className:"w-[30px]",children:e.jsx(te,{checked:ss,indeterminate:as,onCheckedChange:_e,"aria-label":"Select all posts"})}),e.jsx(ne,{className:"w-[40%]",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Title"}),e.jsx(pe,{className:"h-3 w-3"})]})}),e.jsx(ne,{children:"Author"}),e.jsx(ne,{children:"Status"}),e.jsx(ne,{children:"Category"}),e.jsx(ne,{children:"Created"}),e.jsx(ne,{className:"text-right",children:"Analytics"}),e.jsx(ne,{className:"text-right",children:"Actions"})]})}),e.jsx(ce,{children:Ze.map(s=>e.jsxs(re,{children:[e.jsx(de,{children:e.jsx(te,{checked:Pe.includes(s.id),onCheckedChange:e=>Je(e,s.id),"aria-label":`Select post ${s.title}`})}),e.jsxs(de,{children:[e.jsx("div",{className:"font-medium truncate max-w-[300px]",children:s.title}),e.jsx("div",{className:"text-sm text-muted-foreground truncate max-w-[300px]",children:s.slug})]}),e.jsx(de,{children:s.author?.username||"System"}),e.jsx(de,{children:is(s)}),e.jsx(de,{children:rs(s)}),e.jsx(de,{children:ns(s.createdAt)}),e.jsx(de,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end items-center space-x-2 text-muted-foreground text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(O,{className:"h-3.5 w-3.5 mr-1"}),e.jsx("span",{children:s.views||0})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{className:"h-3.5 w-3.5 mr-1"}),e.jsx("span",{children:s.likes||0})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(L,{className:"h-3.5 w-3.5 mr-1"}),e.jsx("span",{children:s.commentCount||0})]})]})}),e.jsx(de,{className:"text-right",children:e.jsx("div",{className:"flex justify-end",children:e.jsxs($,{children:[e.jsx(R,{asChild:!0,children:e.jsxs(c,{variant:"ghost",size:"icon",className:"h-8 w-8",children:[e.jsx(me,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Open menu"})]})}),e.jsxs(H,{align:"end",children:[e.jsx(I,{children:"Actions"}),e.jsxs(D,{onClick:()=>ge(`/reader/${s.slug}`),children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"View"]}),e.jsxs(D,{onClick:()=>Qe(s),children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsxs(D,{onClick:()=>ge(`/admin/analytics?postId=${s.id}`),children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"Analytics"]})]})]})})})]},s.id))})]})})})})}),e.jsx(T,{value:"featured",className:"space-y-4",children:e.jsx(o,{children:e.jsx(u,{className:"p-0",children:ze?e.jsx("div",{className:"flex justify-center items-center h-60",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading featured posts..."})}):0===Ze.length?e.jsx("div",{className:"flex justify-center items-center h-60 flex-col gap-2",children:e.jsx("p",{className:"text-muted-foreground",children:"No featured posts found."})}):e.jsx("div",{className:"relative overflow-x-auto",children:e.jsxs(le,{children:[e.jsx(ie,{children:e.jsxs(re,{children:[e.jsx(ne,{className:"w-[30px]",children:e.jsx(te,{checked:ss,indeterminate:as,onCheckedChange:_e,"aria-label":"Select all posts"})}),e.jsx(ne,{className:"w-[40%]",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Title"}),e.jsx(pe,{className:"h-3 w-3"})]})}),e.jsx(ne,{children:"Author"}),e.jsx(ne,{children:"Status"}),e.jsx(ne,{children:"Category"}),e.jsx(ne,{children:"Created"}),e.jsx(ne,{className:"text-right",children:"Analytics"}),e.jsx(ne,{className:"text-right",children:"Actions"})]})}),e.jsx(ce,{children:Ze.map(s=>e.jsxs(re,{children:[e.jsx(de,{children:e.jsx(te,{checked:Pe.includes(s.id),onCheckedChange:e=>Je(e,s.id),"aria-label":`Select post ${s.title}`})}),e.jsxs(de,{children:[e.jsx("div",{className:"font-medium truncate max-w-[300px]",children:s.title}),e.jsx("div",{className:"text-sm text-muted-foreground truncate max-w-[300px]",children:s.slug})]}),e.jsx(de,{children:s.author?.username||"System"}),e.jsx(de,{children:is(s)}),e.jsx(de,{children:rs(s)}),e.jsx(de,{children:ns(s.createdAt)}),e.jsx(de,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end items-center space-x-2 text-muted-foreground text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(O,{className:"h-3.5 w-3.5 mr-1"}),e.jsx("span",{children:s.views||0})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{className:"h-3.5 w-3.5 mr-1"}),e.jsx("span",{children:s.likes||0})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(L,{className:"h-3.5 w-3.5 mr-1"}),e.jsx("span",{children:s.commentCount||0})]})]})}),e.jsx(de,{className:"text-right",children:e.jsx("div",{className:"flex justify-end",children:e.jsxs($,{children:[e.jsx(R,{asChild:!0,children:e.jsxs(c,{variant:"ghost",size:"icon",className:"h-8 w-8",children:[e.jsx(me,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Open menu"})]})}),e.jsxs(H,{align:"end",children:[e.jsx(I,{children:"Actions"}),e.jsxs(D,{onClick:()=>ge(`/reader/${s.slug}`),children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"View"]}),e.jsxs(D,{onClick:()=>Qe(s),children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsx(z,{}),e.jsxs(D,{onClick:()=>(e=>{We.mutate({id:e.id,feature:!e.featured})})(s),children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Unfeature"]})]})]})})})]},s.id))})]})})})})}),e.jsx(T,{value:"pending",className:"space-y-4",children:e.jsx(o,{children:e.jsx(u,{className:"p-0",children:ze?e.jsx("div",{className:"flex justify-center items-center h-60",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading pending posts..."})}):0===Ze.length?e.jsx("div",{className:"flex justify-center items-center h-60 flex-col gap-2",children:e.jsx("p",{className:"text-muted-foreground",children:"No pending posts found."})}):e.jsx("div",{className:"relative overflow-x-auto",children:e.jsxs(le,{children:[e.jsx(ie,{children:e.jsxs(re,{children:[e.jsx(ne,{className:"w-[30px]",children:e.jsx(te,{checked:ss,indeterminate:as,onCheckedChange:_e,"aria-label":"Select all posts"})}),e.jsx(ne,{className:"w-[40%]",children:"Title"}),e.jsx(ne,{children:"Author"}),e.jsx(ne,{children:"Category"}),e.jsx(ne,{children:"Submitted"}),e.jsx(ne,{className:"text-right",children:"Actions"})]})}),e.jsx(ce,{children:Ze.map(s=>e.jsxs(re,{children:[e.jsx(de,{children:e.jsx(te,{checked:Pe.includes(s.id),onCheckedChange:e=>Je(e,s.id),"aria-label":`Select post ${s.title}`})}),e.jsxs(de,{children:[e.jsx("div",{className:"font-medium truncate max-w-[300px]",children:s.title}),e.jsx("div",{className:"text-sm text-muted-foreground truncate max-w-[300px]",children:s.slug})]}),e.jsx(de,{children:s.author?.username||"Anonymous"}),e.jsx(de,{children:rs(s)}),e.jsx(de,{children:ns(s.createdAt)}),e.jsx(de,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsxs(c,{size:"sm",variant:"outline",onClick:()=>ge(`/reader/${s.slug}`),children:[e.jsx(O,{className:"h-4 w-4 mr-1"}),"View"]}),e.jsxs(c,{size:"sm",variant:"default",onClick:()=>Ye(s),children:[e.jsx(m,{className:"h-4 w-4 mr-1"}),"Approve"]}),e.jsxs(c,{size:"sm",variant:"destructive",onClick:()=>Ke(s),children:[e.jsx(P,{className:"h-4 w-4 mr-1"}),"Reject"]})]})})]},s.id))})]})})})})}),e.jsx(T,{value:"flagged",className:"space-y-4",children:e.jsx(o,{children:e.jsx(u,{className:"p-0",children:ze?e.jsx("div",{className:"flex justify-center items-center h-60",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading flagged posts..."})}):0===Ze.length?e.jsx("div",{className:"flex justify-center items-center h-60 flex-col gap-2",children:e.jsx("p",{className:"text-muted-foreground",children:"No flagged posts found."})}):e.jsx("div",{className:"relative overflow-x-auto",children:e.jsxs(le,{children:[e.jsx(ie,{children:e.jsxs(re,{children:[e.jsx(ne,{className:"w-[30px]",children:e.jsx(te,{checked:ss,indeterminate:as,onCheckedChange:_e,"aria-label":"Select all posts"})}),e.jsx(ne,{className:"w-[35%]",children:"Title"}),e.jsx(ne,{children:"Author"}),e.jsx(ne,{children:"Flag Count"}),e.jsx(ne,{children:"Last Flagged"}),e.jsx(ne,{className:"text-right",children:"Actions"})]})}),e.jsx(ce,{children:Ze.map(s=>e.jsxs(re,{children:[e.jsx(de,{children:e.jsx(te,{checked:Pe.includes(s.id),onCheckedChange:e=>Je(e,s.id),"aria-label":`Select post ${s.title}`})}),e.jsxs(de,{children:[e.jsx("div",{className:"font-medium truncate max-w-[300px]",children:s.title}),e.jsx("div",{className:"text-sm text-muted-foreground truncate max-w-[300px]",children:s.slug})]}),e.jsx(de,{children:s.author?.username||"Anonymous"}),e.jsx(de,{children:e.jsxs(U,{variant:"destructive",children:[s.flagCount||1," ",1===s.flagCount?"flag":"flags"]})}),e.jsx(de,{children:ns(s.updatedAt||s.createdAt)}),e.jsx(de,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsxs(c,{size:"sm",variant:"outline",onClick:()=>ge(`/reader/${s.slug}`),children:[e.jsx(O,{className:"h-4 w-4 mr-1"}),"View"]}),e.jsxs(c,{size:"sm",variant:"default",onClick:()=>Ye(s),children:[e.jsx(S,{className:"h-4 w-4 mr-1"}),"Mark Safe"]}),e.jsxs(c,{size:"sm",variant:"destructive",onClick:()=>Ke(s),children:[e.jsx(xe,{className:"h-4 w-4 mr-1"}),"Remove"]})]})})]},s.id))})]})})})})})]}),e.jsx(G,{open:$e,onOpenChange:Re,children:e.jsxs(V,{className:"sm:max-w-[600px]","aria-labelledby":"edit-post-title","aria-describedby":"edit-post-description",children:[e.jsxs(M,{children:[e.jsx(q,{id:"edit-post-title",children:"Edit Post"}),e.jsx(B,{id:"edit-post-description",children:"Make changes to the post. Click save when you're done."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(W,{htmlFor:"title",className:"text-right",children:"Title"}),e.jsx(b,{id:"title",className:"col-span-3",value:He.title,onChange:e=>Ie({...He,title:e.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(W,{htmlFor:"status",className:"text-right",children:"Status"}),e.jsxs(w,{value:He.status,onValueChange:e=>Ie({...He,status:e}),children:[e.jsx(y,{id:"status",className:"col-span-3",children:e.jsx(C,{placeholder:"Select status"})}),e.jsxs(k,{children:[e.jsx(A,{value:"published",children:"Published"}),e.jsx(A,{value:"draft",children:"Draft"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(W,{htmlFor:"category",className:"text-right",children:"Category"}),e.jsxs(w,{value:He.themeCategory,onValueChange:e=>Ie({...He,themeCategory:e}),children:[e.jsx(y,{id:"category",className:"col-span-3",children:e.jsx(C,{placeholder:"Select category"})}),e.jsxs(k,{children:[e.jsx(A,{value:"",children:"None"}),e.jsx(A,{value:"PSYCHOLOGICAL",children:"Psychological"}),e.jsx(A,{value:"SUPERNATURAL",children:"Supernatural"}),e.jsx(A,{value:"TECHNOLOGICAL",children:"Technological"}),e.jsx(A,{value:"BODY_HORROR",children:"Body Horror"}),e.jsx(A,{value:"GOTHIC",children:"Gothic"}),e.jsx(A,{value:"APOCALYPTIC",children:"Apocalyptic"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(W,{htmlFor:"featured",className:"text-right",children:"Featured"}),e.jsxs("div",{className:"flex items-center col-span-3",children:[e.jsx(te,{id:"featured",checked:He.featured,onCheckedChange:e=>Ie({...He,featured:!0===e})}),e.jsx(W,{htmlFor:"featured",className:"ml-2",children:"Display as featured post"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(W,{htmlFor:"warnings",className:"text-right",children:"Content Warnings"}),e.jsx(Y,{id:"warnings",className:"col-span-3",placeholder:"Enter comma-separated warnings",value:He.triggerWarnings,onChange:e=>Ie({...He,triggerWarnings:e.target.value})})]})]}),e.jsxs(K,{children:[e.jsx(c,{variant:"outline",onClick:()=>Re(!1),children:"Cancel"}),e.jsx(c,{onClick:()=>{if(!Ee)return;const e=He.triggerWarnings?He.triggerWarnings.split(",").map(e=>e.trim()).filter(Boolean):[],s={title:He.title,published:"published"===He.status,featured:He.featured,metadata:{...Ee.metadata,themeCategory:He.themeCategory,triggerWarnings:e}};Me.mutate({id:Ee.id,data:s})},disabled:!He.title.trim()||Me.isPending,children:Me.isPending?"Saving...":"Save Changes"})]})]})}),e.jsx(Q,{open:Fe,onOpenChange:Oe,children:e.jsxs(_,{children:[e.jsxs(J,{children:[e.jsx(X,{children:"Are you absolutely sure?"}),e.jsxs(Z,{children:['This will permanently delete the post "',Ee?.title,'". This action cannot be undone.']})]}),e.jsxs(ee,{children:[e.jsx(se,{children:"Cancel"}),e.jsx(ae,{onClick:()=>{Ee&&Ve.mutate(Ee.id)},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:Ve.isPending?"Deleting...":"Delete"})]})]})})]})}export{ge as default};
