import{j as e}from"./ui-XowJfzQ7.js";import{r as s}from"./router-ft_y90OU.js";import{c as a,B as t,C as l,e as r,f as c,bo as n,h as i,l as d,M as m,N as x,O as o,P as h,I as j,a1 as u,V as f,m as p,g as N,U as b}from"./index-CaZ-hcXF.js";import{C as w}from"./chart-column-increasing-qdZvNszh.js";import{F as v}from"./filter-CwI5yzYg.js";import"./vendor-BbHwBAXo.js";import"./charts-DEf8bB7g.js";import"./utils-SDRWPbZe.js";import"./animations-yM4Nun4l.js";import"./forms-BLyiBPJV.js";function g(){const[g,y]=s.useState(""),[k,A]=s.useState("all"),{data:R,isLoading:C,error:F}=a({queryKey:["/api/user/feedback"],queryFn:async()=>{const e=await fetch("/api/user/feedback",{credentials:"include"});if(!e.ok){if(401===e.status)throw window.location.href="/auth",new Error("Authentication required");throw new Error("Failed to fetch user feedback")}return e.json()}}),{data:L,isLoading:S,error:q}=a({queryKey:["/api/user/feedback/stats"],queryFn:async()=>{const e=await fetch("/api/user/feedback/stats",{credentials:"include"});if(!e.ok){if(401===e.status)throw window.location.href="/auth",new Error("Authentication required");throw new Error("Failed to fetch feedback statistics")}return e.json()}}),E=R?.feedback?R.feedback.filter(e=>{if("all"!==k&&e.status!==k)return!1;if(g.trim()){const s=g.toLowerCase();return e.content.toLowerCase().includes(s)||e.page.toLowerCase().includes(s)||e.category.toLowerCase().includes(s)}return!0}).sort((e,s)=>new Date(s.createdAt).getTime()-new Date(e.createdAt).getTime()):[],D=L?.stats||{total:R?.feedback?.length||0,pending:R?.feedback?R.feedback.filter(e=>"pending"===e.status).length:0,resolved:R?.feedback?R.feedback.filter(e=>"resolved"===e.status).length:0,reviewed:R?.feedback?R.feedback.filter(e=>"reviewed"===e.status).length:0,rejected:R?.feedback?R.feedback.filter(e=>"rejected"===e.status).length:0},P={pending:"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",reviewed:"bg-blue-500/10 text-blue-500 border-blue-500/20",resolved:"bg-green-500/10 text-green-500 border-green-500/20",rejected:"bg-red-500/10 text-red-500 border-red-500/20",all:""},T=e=>new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric"});return e.jsxs("div",{className:"container py-10 max-w-7xl",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Your Feedback Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Track and manage your feedback submissions"})]}),e.jsx(t,{className:"w-full md:w-auto",asChild:!0,children:e.jsx("a",{href:"/feedback",children:"Submit New Feedback"})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4 mb-8",children:[e.jsxs(l,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Total Submissions"}),e.jsx(n,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(i,{children:e.jsx("div",{className:"text-2xl font-bold",children:D.total})})]}),e.jsxs(l,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Pending"}),e.jsx(d,{className:"h-4 w-4 text-yellow-500"})]}),e.jsx(i,{children:e.jsx("div",{className:"text-2xl font-bold",children:D.pending})})]}),e.jsxs(l,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Reviewed"}),e.jsx(m,{className:"h-4 w-4 text-blue-500"})]}),e.jsx(i,{children:e.jsx("div",{className:"text-2xl font-bold",children:D.reviewed})})]}),e.jsxs(l,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Resolved"}),e.jsx(w,{className:"h-4 w-4 text-green-500"})]}),e.jsx(i,{children:e.jsx("div",{className:"text-2xl font-bold",children:D.resolved})})]})]}),e.jsxs(x,{defaultValue:"all",className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between space-y-2 sm:space-y-0 sm:space-x-4",children:[e.jsxs(o,{children:[e.jsx(h,{value:"all",onClick:()=>A("all"),children:"All Feedback"}),e.jsx(h,{value:"pending",onClick:()=>A("pending"),children:"Pending"}),e.jsx(h,{value:"reviewed",onClick:()=>A("reviewed"),children:"Reviewed"}),e.jsx(h,{value:"resolved",onClick:()=>A("resolved"),children:"Resolved"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(v,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(j,{placeholder:"Search feedback...",className:"pl-8 w-full sm:w-[250px]",value:g,onChange:e=>y(e.target.value)})]})]}),e.jsx(u,{value:"all",className:"space-y-4",children:C?Array.from({length:3}).map((s,a)=>e.jsxs(l,{className:"mb-4",children:[e.jsxs(r,{children:[e.jsx(f,{className:"h-5 w-24 mb-2"}),e.jsx(f,{className:"h-4 w-40"})]}),e.jsxs(i,{className:"space-y-2",children:[e.jsx(f,{className:"h-16 w-full"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(f,{className:"h-4 w-20"}),e.jsx(f,{className:"h-4 w-20"})]})]})]},a)):F?e.jsxs(l,{className:"mb-4",children:[e.jsx(r,{children:e.jsx(c,{children:"Error loading feedback"})}),e.jsx(i,{children:e.jsx("p",{className:"text-red-500",children:"Failed to load your feedback. Please try again later."})})]}):0===E?.length?e.jsxs(l,{className:"mb-4",children:[e.jsx(r,{children:e.jsx(c,{children:"No feedback found"})}),e.jsx(i,{children:e.jsx("p",{className:"text-muted-foreground",children:g?"No feedback matches your search criteria.":"You haven't submitted any feedback yet."})})]}):E.map(s=>e.jsxs(l,{className:"mb-4",children:[e.jsxs(r,{className:"pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(p,{variant:"outline",className:P[s.status],children:s.status}),e.jsx(p,{variant:"outline",children:s.type})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:T(s.createdAt)})]}),e.jsx(c,{className:"text-base mt-2",children:s.category}),e.jsx(N,{children:s.page})]}),e.jsxs(i,{className:"space-y-2",children:[e.jsx("p",{className:"text-sm",children:s.content}),s.adminResponse&&e.jsxs("div",{className:"border-t pt-3 mt-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(b,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Admin Response:"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.adminResponse})]})]})]},s.id))}),e.jsx(u,{value:"pending",className:"space-y-4",children:E.filter(e=>"pending"===e.status).map(s=>e.jsxs(l,{className:"mb-4",children:[e.jsxs(r,{className:"pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(p,{variant:"outline",className:P[s.status],children:s.status}),e.jsx(p,{variant:"outline",children:s.type})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:T(s.createdAt)})]}),e.jsx(c,{className:"text-base mt-2",children:s.category}),e.jsx(N,{children:s.page})]}),e.jsx(i,{className:"space-y-2",children:e.jsx("p",{className:"text-sm",children:s.content})})]},s.id))}),e.jsx(u,{value:"reviewed",className:"space-y-4",children:E.filter(e=>"reviewed"===e.status).map(s=>e.jsxs(l,{className:"mb-4",children:[e.jsxs(r,{className:"pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(p,{variant:"outline",className:P[s.status],children:s.status}),e.jsx(p,{variant:"outline",children:s.type})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:T(s.createdAt)})]}),e.jsx(c,{className:"text-base mt-2",children:s.category}),e.jsx(N,{children:s.page})]}),e.jsxs(i,{className:"space-y-2",children:[e.jsx("p",{className:"text-sm",children:s.content}),s.adminResponse&&e.jsxs("div",{className:"border-t pt-3 mt-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(b,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Admin Response:"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.adminResponse})]})]})]},s.id))}),e.jsx(u,{value:"resolved",className:"space-y-4",children:E.filter(e=>"resolved"===e.status).map(s=>e.jsxs(l,{className:"mb-4",children:[e.jsxs(r,{className:"pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(p,{variant:"outline",className:P[s.status],children:s.status}),e.jsx(p,{variant:"outline",children:s.type})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:T(s.createdAt)})]}),e.jsx(c,{className:"text-base mt-2",children:s.category}),e.jsx(N,{children:s.page})]}),e.jsxs(i,{className:"space-y-2",children:[e.jsx("p",{className:"text-sm",children:s.content}),s.adminResponse&&e.jsxs("div",{className:"border-t pt-3 mt-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(b,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Admin Response:"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.adminResponse})]})]})]},s.id))})]})]})}export{g as default};
