import{j as e}from"./ui-XowJfzQ7.js";import{u as s,L as a,r as l}from"./router-ft_y90OU.js";import{q as c,b7 as t,bo as n,ba as r,a0 as i,bx as d,F as m,aG as o,bA as h,a as x,c as p,d as u,C as j,e as v,f as y,g as N,h as f,I as b,L as g,aH as w,b6 as k,ay as C,az as M,aA as S,aB as L,aC as q,B as z,R as A,W as I,j as P,bB as H,bC as T,bD as F,bE as V,l as D,bF as E,aM as O,bG as R,bq as U,bH as B,bI as G,bJ as K,bK as W}from"./index-CaZ-hcXF.js";import{T as _,b as Q,c as J,d as Z,e as $,f as X}from"./table-CIMJ6G5B.js";import{L as Y}from"./layout-dashboard-PKafkZmC.js";import{G as ee}from"./globe-DlAfDjMl.js";import{T as se}from"./theme-categories-lLtkwf9j.js";import{P as ae}from"./pencil-RjeK00tF.js";import{C as le}from"./copy-BOuW94H4.js";import{U as ce}from"./user-plus-Bwzf3kyX.js";import"./vendor-BbHwBAXo.js";import"./charts-DEf8bB7g.js";import"./utils-SDRWPbZe.js";import"./animations-yM4Nun4l.js";import"./forms-BLyiBPJV.js";const te=c("Axe",[["path",{d:"m14 12-8.5 8.5a2.12 2.12 0 1 1-3-3L11 9",key:"csbz4o"}],["path",{d:"M15 13 9 7l4-4 6 6h3a8 8 0 0 1-7 7z",key:"113wfo"}]]),ne=c("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]),re=c("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]),ie=c("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]),de=c("Hourglass",[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]]),me=c("ScanFace",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["path",{d:"M9 9h.01",key:"1q5me6"}],["path",{d:"M15 9h.01",key:"x1ddxp"}]]),oe=c("Scan",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]),he=c("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]),xe=c("Syringe",[["path",{d:"m18 2 4 4",key:"22kx64"}],["path",{d:"m17 7 3-3",key:"1w1zoj"}],["path",{d:"M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-.6-.6c-1-1-1-2.5 0-3.4L15 5",key:"1exhtz"}],["path",{d:"m9 11 4 4",key:"rovt3i"}],["path",{d:"m5 19-3 3",key:"59f2uf"}],["path",{d:"m14 4 6 6",key:"yqp9t2"}]]),pe=c("Tally4",[["path",{d:"M4 4v16",key:"6qkkli"}],["path",{d:"M9 4v16",key:"81ygyz"}],["path",{d:"M14 4v16",key:"12vmem"}],["path",{d:"M19 4v16",key:"8ij5ei"}]]),ue=c("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]]),je=c("Wind",[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]]),ve=c("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),ye=[{group:"Dashboard",items:[{name:"Overview",href:"/admin",icon:Y}]},{group:"Content Management",items:[{name:"Stories",href:"/admin/stories",icon:t},{name:"Themes",href:"/admin/themes",icon:n},{name:"WordPress Sync",href:"/admin/wordpress-sync",icon:ee}]},{group:"User Management",items:[{name:"Users",href:"/admin/users",icon:r},{name:"Moderation",href:"/admin/moderation",icon:i}]},{group:"Insights & Reports",items:[{name:"Analytics",href:"/admin/analytics",icon:d},{name:"Feedback",href:"/admin/feedback",icon:n}]},{group:"System",items:[{name:"Settings",href:"/admin/settings",icon:m},{name:"Email Services",href:"/admin/email-test",icon:o},{name:"Database",href:"/admin/database",icon:h}]}];function Ne({children:l,title:c}){const[t]=s();return e.jsxs("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx("header",{className:"sticky top-0 z-40 border-b bg-background",children:e.jsxs("div",{className:"flex h-16 items-center justify-between px-4 sm:px-6",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs(a,{href:"/",className:"flex items-center",children:[e.jsx("span",{className:"text-xl font-semibold",children:"Bubble's Café"}),e.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:"Admin"})]})}),e.jsx("div",{className:"flex items-center gap-4"})]})}),e.jsxs("div",{className:"flex min-h-[calc(100vh-4rem)]",children:[e.jsx("aside",{className:"hidden w-64 border-r bg-background md:block",children:e.jsx("nav",{className:"flex flex-col gap-2 p-4",children:ye.map(s=>e.jsxs("div",{className:"space-y-2 pt-2 first:pt-0",children:[e.jsx("h3",{className:"px-2 text-xs font-semibold tracking-tight text-muted-foreground",children:s.group}),e.jsx("div",{className:"space-y-1",children:s.items.map(s=>{const l=t===s.href||"/admin"!==s.href&&t.startsWith(s.href);return e.jsxs(a,{href:s.href,className:"flex items-center rounded-md px-2 py-2 text-sm font-medium "+(l?"bg-accent text-accent-foreground":"text-muted-foreground hover:bg-accent/50 hover:text-accent-foreground"),children:[e.jsx(s.icon,{className:"mr-2 h-4 w-4"}),s.name]},s.name)})})]},s.group))})}),e.jsxs("main",{className:"flex-1 p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:c})}),e.jsx("div",{className:"rounded-lg border bg-card p-6 shadow-sm",children:l})]})]})]})}const fe={skull:e.jsx(W,{className:"h-4 w-4"}),brain:e.jsx(K,{className:"h-4 w-4"}),ghost:e.jsx(G,{className:"h-4 w-4"}),eye:e.jsx(k,{className:"h-4 w-4"}),scissors:e.jsx(he,{className:"h-4 w-4"}),hourglass:e.jsx(de,{className:"h-4 w-4"}),footprints:e.jsx(B,{className:"h-4 w-4"}),utensils:e.jsx(ue,{className:"h-4 w-4"}),axe:e.jsx(te,{className:"h-4 w-4"}),car:e.jsx(ne,{className:"h-4 w-4"}),"user-plus":e.jsx(ce,{className:"h-4 w-4"}),bug:e.jsx(U,{className:"h-4 w-4"}),cpu:e.jsx(R,{className:"h-4 w-4"}),globe:e.jsx(ee,{className:"h-4 w-4"}),doll:e.jsx(O,{className:"h-4 w-4"}),scan:e.jsx(oe,{className:"h-4 w-4"}),castle:e.jsx(E,{className:"h-4 w-4"}),copy:e.jsx(le,{className:"h-4 w-4"}),clock:e.jsx(D,{className:"h-4 w-4"}),"cloud-rain":e.jsx(V,{className:"h-4 w-4"}),alien:e.jsx(ve,{className:"h-4 w-4"}),cloud:e.jsx(F,{className:"h-4 w-4"}),droplets:e.jsx(re,{className:"h-4 w-4"}),sparkles:e.jsx(T,{className:"h-4 w-4"}),syringe:e.jsx(xe,{className:"h-4 w-4"}),wind:e.jsx(je,{className:"h-4 w-4"}),scanface:e.jsx(me,{className:"h-4 w-4"}),tally4:e.jsx(pe,{className:"h-4 w-4"}),heart:e.jsx(H,{className:"h-4 w-4"}),flame:e.jsx(ie,{className:"h-4 w-4"})},be=[{value:"skull",label:"Skull"},{value:"brain",label:"Brain"},{value:"ghost",label:"Ghost"},{value:"eye",label:"Eye"},{value:"scissors",label:"Scissors"},{value:"hourglass",label:"Hourglass"},{value:"footprints",label:"Footprints"},{value:"utensils",label:"Utensils"},{value:"axe",label:"Axe"},{value:"car",label:"Car"},{value:"user-plus",label:"Doppelgänger"},{value:"bug",label:"Bug"},{value:"cpu",label:"CPU"},{value:"globe",label:"Globe"},{value:"doll",label:"Doll"},{value:"scan",label:"Scan"},{value:"castle",label:"Castle"},{value:"copy",label:"Copy"},{value:"clock",label:"Clock"},{value:"cloud-rain",label:"Rain"},{value:"alien",label:"Alien"},{value:"cloud",label:"Cloud"},{value:"droplets",label:"Droplets"},{value:"sparkles",label:"Sparkles"},{value:"syringe",label:"Syringe"},{value:"wind",label:"Wind"},{value:"scanface",label:"Scan Face"},{value:"tally4",label:"Ritual Marks"},{value:"heart",label:"Heart"},{value:"flame",label:"Flame"}];function ge(){const{toast:s}=x(),[a,c]=l.useState(""),[t,n]=l.useState(null),[r,i]=l.useState(""),[d,m]=l.useState(""),[o,h]=l.useState(""),[H,T]=l.useState(!1),{data:F,isLoading:V,error:D}=p({queryKey:["/api/posts/admin/themes"],queryFn:async()=>{const e=await fetch("/api/posts/admin/themes",{credentials:"include"});if(!e.ok)throw new Error("Failed to fetch posts");return e.json()}}),E=u({mutationFn:async({id:e,themeCategory:s,themeIcon:a})=>{const l=a||d;return P(`/api/posts/${e}/theme`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({themeCategory:s,themeIcon:l,theme_category:s,icon:l})})},onSuccess:()=>{I.invalidateQueries({queryKey:["/api/posts/admin/themes"]}),I.invalidateQueries({queryKey:["/api/posts"]}),I.invalidateQueries({queryKey:["wordpress","posts"]}),s({title:"Theme updated",description:"The post theme has been successfully updated."}),n(null)},onError:e=>{s({title:"Update failed",description:"Failed to update the post theme. Please try again.",variant:"destructive"})}}),O=F?F.filter(e=>e.title.toLowerCase().includes(a.toLowerCase())):[];return e.jsx(Ne,{title:"Theme Management",children:e.jsxs(j,{className:"w-full",children:[e.jsxs(v,{children:[e.jsx(y,{children:"Theme Management"}),e.jsx(N,{children:"Manage theme categories for all posts. Each post can be assigned to one of the predefined horror theme categories with a corresponding icon."})]}),e.jsxs(f,{children:[e.jsx("div",{className:"mb-4",children:e.jsx(b,{placeholder:"Search posts...",value:a,onChange:e=>c(e.target.value),className:"max-w-sm"})}),V?e.jsxs("div",{className:"flex items-center justify-center p-8",children:[e.jsx(g,{className:"h-8 w-8 animate-spin text-primary"}),e.jsx("span",{className:"ml-2",children:"Loading posts..."})]}):D?e.jsxs("div",{className:"flex items-center p-4 text-red-500",children:[e.jsx(w,{className:"mr-2 h-5 w-5"}),e.jsx("span",{children:"Failed to load posts. Please try again."})]}):e.jsx("div",{className:"overflow-x-auto rounded-md border",children:e.jsxs(_,{children:[e.jsx(Q,{children:e.jsxs(J,{children:[e.jsx(Z,{children:"Title"}),e.jsx(Z,{className:"hidden md:table-cell",children:"Current Theme"}),e.jsx(Z,{className:"hidden md:table-cell",children:"Icon"}),e.jsx(Z,{children:"Actions"})]})}),e.jsx($,{children:0===O.length?e.jsx(J,{children:e.jsx(X,{colSpan:4,className:"text-center",children:"No posts found"})}):O.map(s=>{const a=s.themeCategory||s.theme_category,l=a?se[a]:null,c=s.metadata?.themeIcon,x=s.themeIcon||s.theme_icon||c||l?.icon||"eye";return e.jsxs(J,{children:[e.jsx(X,{className:"font-medium",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:s.title}),e.jsxs("span",{className:"md:hidden text-xs text-muted-foreground mt-1 flex items-center",children:[fe[x.toLowerCase()]||e.jsx(k,{className:"h-3 w-3"}),e.jsx("span",{className:"ml-1",children:l?.label||"Horror"})]})]})}),e.jsx(X,{className:"hidden md:table-cell",children:t===s.id?e.jsxs(C,{value:r,onValueChange:e=>{i(e);const s=se[e];m(s?.icon||"eye")},disabled:E.isPending,children:[e.jsx(M,{className:"w-full md:w-[180px]",children:e.jsx(S,{placeholder:"Select a theme"})}),e.jsx(L,{children:Object.entries(se).map(([s,{label:a}])=>e.jsx(q,{value:s,children:a},s))})]}):e.jsx("span",{children:l?.label||"None"})}),e.jsx(X,{className:"hidden md:table-cell",children:t===s.id?e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs(C,{value:d,onValueChange:e=>{m(e),"custom"===e?T(!0):(T(!1),h(""))},disabled:E.isPending,children:[e.jsx(M,{className:"w-full md:w-[180px]",children:e.jsx(S,{placeholder:"Select an icon",children:e.jsxs("div",{className:"flex items-center",children:["custom"!==d?fe[d.toLowerCase()]||e.jsx(k,{className:"h-4 w-4"}):e.jsxs("span",{className:"flex items-center",children:[fe[o.toLowerCase()]||e.jsx(k,{className:"h-4 w-4"}),e.jsxs("span",{className:"ml-2 truncate max-w-[100px]",children:["Custom: ",o||"none"]})]}),"custom"!==d&&e.jsx("span",{className:"ml-2 truncate",children:be.find(e=>e.value===d.toLowerCase())?.label||"Icon"})]})})}),e.jsxs(L,{children:[e.jsx(q,{value:"custom",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx("span",{className:"ml-2",children:"Custom Icon..."})]})}),e.jsx("div",{className:"px-2 py-1.5 text-xs font-medium text-muted-foreground border-b",children:"Preset Icons"}),be.map(s=>e.jsx(q,{value:s.value,children:e.jsxs("div",{className:"flex items-center",children:[fe[s.value],e.jsx("span",{className:"ml-2",children:s.label})]})},s.value))]})]}),"custom"===d&&H&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{placeholder:"Type a custom icon name",value:o,onChange:e=>h(e.target.value.toLowerCase()),className:"w-full md:w-[180px]"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Preview: "}),e.jsxs("span",{className:"ml-2 flex items-center",children:[fe[o.toLowerCase()]||e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{className:"ml-1",children:o||"eye"})]})]})]})]})}):e.jsxs("div",{className:"flex items-center",children:[fe[x.toLowerCase()]||e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{className:"ml-2",children:be.find(e=>e.value===x.toLowerCase())?.label||x})]})}),e.jsx(X,{children:t===s.id?e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("div",{className:"md:hidden space-y-2 mb-2",children:[e.jsxs(C,{value:r,onValueChange:e=>{i(e);const s=se[e];m(s?.icon||"eye")},disabled:E.isPending,children:[e.jsx(M,{className:"w-full",children:e.jsx(S,{placeholder:"Select a theme"})}),e.jsx(L,{children:Object.entries(se).map(([s,{label:a}])=>e.jsx(q,{value:s,children:a},s))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(C,{value:d,onValueChange:e=>{m(e),"custom"===e?T(!0):(T(!1),h(""))},disabled:E.isPending,children:[e.jsx(M,{className:"w-full",children:e.jsx(S,{placeholder:"Select an icon",children:e.jsxs("div",{className:"flex items-center",children:["custom"!==d?fe[d.toLowerCase()]||e.jsx(k,{className:"h-4 w-4"}):e.jsxs("span",{className:"flex items-center",children:[fe[o.toLowerCase()]||e.jsx(k,{className:"h-4 w-4"}),e.jsxs("span",{className:"ml-2 truncate max-w-[100px]",children:["Custom: ",o||"none"]})]}),"custom"!==d&&e.jsx("span",{className:"ml-2 truncate",children:be.find(e=>e.value===d.toLowerCase())?.label||"Icon"})]})})}),e.jsxs(L,{children:[e.jsx(q,{value:"custom",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx("span",{className:"ml-2",children:"Custom Icon..."})]})}),e.jsx("div",{className:"px-2 py-1.5 text-xs font-medium text-muted-foreground border-b",children:"Preset Icons"}),be.map(s=>e.jsx(q,{value:s.value,children:e.jsxs("div",{className:"flex items-center",children:[fe[s.value],e.jsx("span",{className:"ml-2",children:s.label})]})},s.value))]})]}),"custom"===d&&H&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{placeholder:"Type a custom icon name",value:o,onChange:e=>h(e.target.value.toLowerCase()),className:"w-full"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Preview: "}),e.jsxs("span",{className:"ml-2 flex items-center",children:[fe[o.toLowerCase()]||e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{className:"ml-1",children:o||"eye"})]})]})]})]})]}),e.jsxs(z,{size:"sm",variant:"outline",onClick:()=>(e=>{if(r){const s="custom"===d?o||"ghost":d;E.mutate({id:e,themeCategory:r,themeIcon:s})}})(s.id),disabled:E.isPending,className:"w-full sm:w-auto",children:[E.isPending?e.jsx(g,{className:"h-4 w-4 animate-spin"}):e.jsx(A,{className:"h-4 w-4"}),e.jsx("span",{className:"ml-1",children:"Save"})]}),e.jsx(z,{size:"sm",variant:"ghost",onClick:()=>n(null),disabled:E.isPending,className:"w-full sm:w-auto",children:"Cancel"})]}):e.jsxs(z,{size:"sm",variant:"ghost",onClick:()=>(e=>{n(e.id);const s=e.themeCategory||e.theme_category||"HORROR";i(s);const a=e.metadata?.themeIcon,l=e.themeIcon||e.theme_icon||a;if(l)m(l),Object.keys(fe).includes(l.toLowerCase())||(m("custom"),h(l),T(!0));else{const e=se[s];m(e?.icon||"eye"),T(!1),h("")}})(s),className:"flex items-center",children:[e.jsx(ae,{className:"h-4 w-4 mr-1"}),"Edit"]})})]},s.id)})})]})})]})]})})}export{ge as default};
