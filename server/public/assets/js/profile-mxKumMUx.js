import{a1 as e,W as s,l as a,j as r,d as i,a2 as n,P as t,u as l,a3 as o,n as d,e as c,a4 as m}from"./ui-XowJfzQ7.js";import{r as u}from"./router-ft_y90OU.js";import{q as x,Y as h,Z as p,_ as j,u as f,a as y,$ as v,N as w,O as b,P as g,a0 as N,a1 as k,C as P,e as C,f as R,g as S,h as A,L as V,B as E,a2 as _,a3 as q,a4 as U,a5 as D,a6 as M,I as F,a7 as I,a8 as L,T,p as Y,n as B,a9 as G,aa as z,ab as H,ac as O,ad as W,ae as X,af as Z,ag as $,ah as J,i as K,ai as Q,aj as ee,ak as se,al as ae,am as re,an as ie}from"./index-CaZ-hcXF.js";import{b as ne}from"./forms-BLyiBPJV.js";import{A as te,a as le,b as oe}from"./avatar-BbyEipG6.js";import{C as de}from"./checkbox-CZs5qr2K.js";import{S as ce,C as me}from"./SettingsLayout-BaQsAq__.js";import{U as ue}from"./upload-DeAa565m.js";import"./vendor-BbHwBAXo.js";import"./charts-DEf8bB7g.js";import"./utils-SDRWPbZe.js";import"./animations-yM4Nun4l.js";import"./cookie-BAtp2yjH.js";const xe=x("UserRoundX",[["path",{d:"M2 21a8 8 0 0 1 11.873-7",key:"74fkxq"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"m17 17 5 5",key:"p7ous7"}],["path",{d:"m22 17-5 5",key:"gqnmv0"}]]);var he="Radio",[pe,je]=i(he),[fe,ye]=pe(he),ve=u.forwardRef((e,s)=>{const{__scopeRadio:a,name:i,checked:n=!1,required:o,disabled:c,value:m="on",onCheck:x,form:h,...p}=e,[j,f]=u.useState(null),y=l(s,e=>f(e)),v=u.useRef(!1),w=!j||(h||!!j.closest("form"));return r.jsxs(fe,{scope:a,checked:n,disabled:c,children:[r.jsx(t.button,{type:"button",role:"radio","aria-checked":n,"data-state":Ne(n),"data-disabled":c?"":void 0,disabled:c,value:m,...p,ref:y,onClick:d(e.onClick,e=>{n||x?.(),w&&(v.current=e.isPropagationStopped(),v.current||e.stopPropagation())})}),w&&r.jsx(ge,{control:j,bubbles:!v.current,name:i,value:m,checked:n,required:o,disabled:c,form:h,style:{transform:"translateX(-100%)"}})]})});ve.displayName=he;var we="RadioIndicator",be=u.forwardRef((e,s)=>{const{__scopeRadio:a,forceMount:i,...n}=e,l=ye(we,a);return r.jsx(c,{present:i||l.checked,children:r.jsx(t.span,{"data-state":Ne(l.checked),"data-disabled":l.disabled?"":void 0,...n,ref:s})})});be.displayName=we;var ge=u.forwardRef(({__scopeRadio:e,control:s,checked:a,bubbles:i=!0,...n},o)=>{const d=u.useRef(null),c=l(d,o),x=h(a),p=m(s);return u.useEffect(()=>{const e=d.current;if(!e)return;const s=window.HTMLInputElement.prototype,r=Object.getOwnPropertyDescriptor(s,"checked").set;if(x!==a&&r){const s=new Event("click",{bubbles:i});r.call(e,a),e.dispatchEvent(s)}},[x,a,i]),r.jsx(t.input,{type:"radio","aria-hidden":!0,defaultChecked:a,...n,tabIndex:-1,ref:c,style:{...n.style,...p,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function Ne(e){return e?"checked":"unchecked"}ge.displayName="RadioBubbleInput";var ke=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Pe="RadioGroup",[Ce,Re]=i(Pe,[e,je]),Se=e(),Ae=je(),[Ve,Ee]=Ce(Pe),_e=u.forwardRef((e,i)=>{const{__scopeRadioGroup:l,name:o,defaultValue:d,value:c,required:m=!1,disabled:u=!1,orientation:x,dir:h,loop:p=!0,onValueChange:j,...f}=e,y=Se(l),v=s(h),[w,b]=a({prop:c,defaultProp:d??null,onChange:j,caller:Pe});return r.jsx(Ve,{scope:l,name:o,required:m,disabled:u,value:w,onValueChange:b,children:r.jsx(n,{asChild:!0,...y,orientation:x,dir:v,loop:p,children:r.jsx(t.div,{role:"radiogroup","aria-required":m,"aria-orientation":x,"data-disabled":u?"":void 0,dir:v,...f,ref:i})})})});_e.displayName=Pe;var qe="RadioGroupItem",Ue=u.forwardRef((e,s)=>{const{__scopeRadioGroup:a,disabled:i,...n}=e,t=Ee(qe,a),c=t.disabled||i,m=Se(a),x=Ae(a),h=u.useRef(null),p=l(s,h),j=t.value===n.value,f=u.useRef(!1);return u.useEffect(()=>{const e=e=>{ke.includes(e.key)&&(f.current=!0)},s=()=>f.current=!1;return document.addEventListener("keydown",e),document.addEventListener("keyup",s),()=>{document.removeEventListener("keydown",e),document.removeEventListener("keyup",s)}},[]),r.jsx(o,{asChild:!0,...m,focusable:!c,active:j,children:r.jsx(ve,{disabled:c,required:t.required,checked:j,...x,...n,name:t.name,ref:p,onCheck:()=>t.onValueChange(n.value),onKeyDown:d(e=>{"Enter"===e.key&&e.preventDefault()}),onFocus:d(n.onFocus,()=>{f.current&&h.current?.click()})})})});Ue.displayName=qe;var De=u.forwardRef((e,s)=>{const{__scopeRadioGroup:a,...i}=e,n=Ae(a);return r.jsx(be,{...n,...i,ref:s})});De.displayName="RadioGroupIndicator";var Me=_e,Fe=Ue,Ie=De;const Le=u.forwardRef(({className:e,...s},a)=>r.jsx(Me,{className:p("grid gap-2",e),...s,ref:a}));Le.displayName=Me.displayName;const Te=u.forwardRef(({className:e,...s},a)=>r.jsx(Fe,{ref:a,className:p("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...s,children:r.jsx(Ie,{className:"flex items-center justify-center",children:r.jsx(j,{className:"h-2.5 w-2.5 fill-current text-current"})})}));Te.displayName=Fe.displayName;const Ye=se({username:ae().min(3,"Username must be at least 3 characters"),email:ae().email("Please enter a valid email address"),fullName:ae().optional(),bio:ae().max(250,"Bio cannot exceed 250 characters").optional(),currentPassword:ae().min(1,"Current password is required"),newPassword:ae().optional(),confirmPassword:ae().optional()}).refine(e=>!e.newPassword||e.newPassword===e.confirmPassword,{message:"Passwords do not match",path:["confirmPassword"]}),Be=se({displayMode:ie(["username","anonymous"]),showReadingHistory:re(),showBookmarks:re(),allowMentions:re()});function Ge(){const{user:e}=f(),{toast:s}=y(),[a,i]=u.useState("personal"),[n,t]=u.useState(!1),[l,o]=u.useState(!1),[d,c]=u.useState(null),m=ne({resolver:v(Ye),defaultValues:{username:e?.username||"",email:e?.email||"",fullName:"",bio:e?.bio||"",currentPassword:"",newPassword:"",confirmPassword:""}}),x=ne({resolver:v(Be),defaultValues:{displayMode:"username",showReadingHistory:!0,showBookmarks:!1,allowMentions:!0}});return r.jsx(ce,{title:"Profile Settings",children:r.jsxs(w,{defaultValue:a,onValueChange:i,className:"w-full",children:[r.jsxs(b,{className:"mb-6 w-full md:w-auto",children:[r.jsxs(g,{value:"personal",className:"flex items-center gap-2",children:[r.jsx(me,{className:"h-4 w-4"}),r.jsx("span",{children:"Personal Info"})]}),r.jsxs(g,{value:"visibility",className:"flex items-center gap-2",children:[r.jsx(N,{className:"h-4 w-4"}),r.jsx("span",{children:"Visibility"})]})]}),r.jsxs(k,{value:"personal",className:"space-y-6 mt-4",children:[r.jsxs(P,{children:[r.jsxs(C,{className:"pb-4",children:[r.jsx(R,{children:"Profile Picture"}),r.jsx(S,{children:"Your profile picture will be shown on your profile and in comments"})]}),r.jsx(A,{className:"space-y-4",children:r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4",children:[r.jsx("div",{className:"flex justify-center sm:justify-start",children:r.jsx("div",{className:"relative",children:r.jsxs(te,{className:"h-24 w-24",children:[r.jsx(le,{src:d||void 0,alt:e?.username||"Avatar"}),r.jsx(oe,{className:"text-xl",children:e?.username?.charAt(0).toUpperCase()||"U"}),l&&r.jsx("div",{className:"absolute inset-0 bg-black/50 rounded-full flex items-center justify-center",children:r.jsx(V,{className:"h-8 w-8 text-white animate-spin"})})]})})}),r.jsx("div",{className:"flex-1 space-y-4",children:r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground pb-2",children:"Upload a photo for your profile. This helps readers and authors recognize you in the community."}),r.jsxs("div",{className:"flex flex-col xs:flex-row gap-2",children:[r.jsxs(E,{type:"button",variant:"outline",size:"sm",className:"relative",disabled:l,children:[r.jsx(ue,{className:"mr-2 h-4 w-4"}),r.jsx("span",{children:"Upload New Picture"}),r.jsx("input",{type:"file",accept:"image/*",className:"absolute inset-0 opacity-0 cursor-pointer",onChange:e=>{const a=e.target.files?.[0];if(!a)return;if(!a.type.startsWith("image/"))return void s({title:"Invalid file type",description:"Please select an image file (JPEG, PNG, etc.)",variant:"destructive"});if(a.size>5242880)return void s({title:"File too large",description:"Avatar image must be less than 5MB",variant:"destructive"});o(!0);const r=new FileReader;r.onload=e=>{e.target?.result&&c(e.target.result)},r.readAsDataURL(a),setTimeout(()=>{o(!1),s({title:"Avatar updated",description:"Your profile picture has been updated successfully."})},1500)},disabled:l})]}),d&&r.jsx(E,{type:"button",variant:"ghost",size:"sm",className:"text-destructive hover:text-destructive",onClick:()=>c(null),disabled:l,children:"Remove Photo"})]})]})})]})})]}),r.jsxs(P,{children:[r.jsxs(C,{children:[r.jsx(R,{children:"Account Information"}),r.jsx(S,{children:"Update your personal information and account details"})]}),r.jsx(A,{children:r.jsx(_,{...m,children:r.jsxs("form",{id:"profile-form",onSubmit:m.handleSubmit(async e=>{try{await new Promise(e=>setTimeout(e,1e3)),ee.success("Profile updated successfully",{description:"Your profile settings have been updated."}),m.setValue("currentPassword",""),m.setValue("newPassword",""),m.setValue("confirmPassword","")}catch(s){ee.error("Failed to update profile",{description:"Please try again."})}}),className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(q,{control:m.control,name:"fullName",render:({field:e})=>r.jsxs(U,{children:[r.jsx(D,{children:"Full Name"}),r.jsx(M,{children:r.jsx(F,{placeholder:"Enter your full name",...e,value:e.value||""})}),r.jsx(I,{children:"Your name as it will appear on your profile page"}),r.jsx(L,{})]})}),r.jsx(q,{control:m.control,name:"username",render:({field:e})=>r.jsxs(U,{children:[r.jsx(D,{children:"Username"}),r.jsx(M,{children:r.jsx(F,{...e})}),r.jsx(I,{children:"Your unique identifier on the platform"}),r.jsx(L,{})]})})]}),r.jsx(q,{control:m.control,name:"email",render:({field:e})=>r.jsxs(U,{children:[r.jsx(D,{children:"Email"}),r.jsx(M,{children:r.jsx(F,{type:"email",...e})}),r.jsx(I,{children:"Used for account notifications and recovery"}),r.jsx(L,{})]})}),r.jsx(q,{control:m.control,name:"bio",render:({field:e})=>r.jsxs(U,{children:[r.jsx(D,{children:"Bio"}),r.jsx(M,{children:r.jsx(T,{placeholder:"Tell the community a little about yourself...",className:"min-h-[120px] resize-y",...e,value:e.value||""})}),r.jsxs(I,{children:[r.jsxs("span",{className:""+(m.watch("bio")?.length?"text-destructive":""),children:[m.watch("bio")?.length||0,"/250"]})," characters"]}),r.jsx(L,{})]})}),r.jsx(Y,{className:"my-6"}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Change Password"}),r.jsxs("div",{className:"space-y-4",children:[r.jsx(q,{control:m.control,name:"currentPassword",render:({field:e})=>r.jsxs(U,{children:[r.jsx(D,{children:"Current Password"}),r.jsx(M,{children:r.jsx(F,{type:"password",...e})}),r.jsx(L,{})]})}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(q,{control:m.control,name:"newPassword",render:({field:e})=>r.jsxs(U,{children:[r.jsx(D,{children:"New Password"}),r.jsx(M,{children:r.jsx(F,{type:"password",...e})}),r.jsx(L,{})]})}),r.jsx(q,{control:m.control,name:"confirmPassword",render:({field:e})=>r.jsxs(U,{children:[r.jsx(D,{children:"Confirm New Password"}),r.jsx(M,{children:r.jsx(F,{type:"password",...e})}),r.jsx(L,{})]})})]})]})]})]})})}),r.jsx(B,{className:"border-t px-6 py-4",children:r.jsxs(E,{type:"submit",form:"profile-form",disabled:m.formState.isSubmitting,className:"ml-auto",children:[m.formState.isSubmitting&&r.jsx(V,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Changes"]})})]}),r.jsxs(P,{className:"border-destructive/30",children:[r.jsxs(C,{className:"pb-3",children:[r.jsxs(R,{className:"flex items-center text-destructive",children:[r.jsx(xe,{className:"mr-2 h-5 w-5"}),r.jsx("span",{children:"Danger Zone"})]}),r.jsx(S,{children:"Actions here will permanently affect your account"})]}),r.jsxs(A,{children:[r.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Once you deactivate your account, all your data will be permanently deleted. This action cannot be undone."}),r.jsxs(G,{children:[r.jsx(z,{asChild:!0,children:r.jsx(E,{variant:"destructive",size:"sm",children:"Deactivate Account"})}),r.jsxs(H,{children:[r.jsxs(O,{children:[r.jsx(W,{children:"Are you absolutely sure?"}),r.jsx(X,{children:"This action cannot be undone. This will permanently delete your account and remove all your data from our servers."})]}),r.jsxs(Z,{children:[r.jsx($,{children:"Cancel"}),r.jsx(J,{onClick:async()=>{t(!0);try{await new Promise(e=>setTimeout(e,2e3)),ee.success("Account deactivated",{description:"Your account has been deactivated successfully."})}catch(e){ee.error("Failed to deactivate account",{description:"Please try again."})}t(!1)},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",disabled:n,children:n?r.jsxs(r.Fragment,{children:[r.jsx(V,{className:"mr-2 h-4 w-4 animate-spin"}),"Deactivating..."]}):"Yes, deactivate my account"})]})]})]})]})]})]}),r.jsx(k,{value:"visibility",className:"space-y-6 mt-4",children:r.jsxs(P,{children:[r.jsxs(C,{children:[r.jsx(R,{children:"Profile Visibility"}),r.jsx(S,{children:"Control who can see your profile and activity"})]}),r.jsx(A,{children:r.jsx(_,{...x,children:r.jsx("form",{id:"visibility-form",onSubmit:x.handleSubmit(async e=>{try{await new Promise(e=>setTimeout(e,800)),ee.success("Visibility settings updated",{description:`Your profile is now set to ${"username"===e.displayMode?"display your username":"remain anonymous"}.`})}catch(s){ee.error("Failed to update visibility settings",{description:"Please try again."})}}),className:"space-y-6",children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-sm font-medium",children:"Identity Display"}),r.jsx(q,{control:x.control,name:"displayMode",render:({field:e})=>r.jsxs(U,{className:"space-y-2",children:[r.jsx(M,{children:r.jsxs(Le,{onValueChange:e.onChange,defaultValue:e.value,className:"mt-2 flex flex-col space-y-3",children:[r.jsxs("div",{className:"flex items-start space-x-3 bg-muted/40 rounded-md p-3",children:[r.jsx(Te,{value:"username",id:"display-username",className:"mt-1"}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(K,{htmlFor:"display-username",className:"font-medium",children:"Display Username"}),r.jsx("p",{className:"text-sm text-muted-foreground leading-snug",children:"Your username will be displayed with your comments and interactions. People can find and follow your contributions."})]})]}),r.jsxs("div",{className:"flex items-start space-x-3 bg-muted/40 rounded-md p-3",children:[r.jsx(Te,{value:"anonymous",id:"remain-anonymous",className:"mt-1"}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(K,{htmlFor:"remain-anonymous",className:"font-medium",children:"Remain Anonymous"}),r.jsx("p",{className:"text-sm text-muted-foreground leading-snug",children:'Your activity will be posted anonymously without revealing your identity. Comments will show as "Anonymous Reader".'})]})]})]})}),r.jsx(L,{})]})})]}),r.jsx(Y,{className:"my-4"}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-sm font-medium",children:"Additional Visibility Settings"}),r.jsx(q,{control:x.control,name:"showReadingHistory",render:({field:e})=>r.jsxs(U,{className:"flex flex-row items-start space-x-3 space-y-0 bg-muted/40 rounded-md p-3",children:[r.jsx(M,{children:r.jsx(de,{checked:e.value,onCheckedChange:e.onChange})}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(K,{className:"font-medium",children:"Show Reading History"}),r.jsx(I,{className:"text-sm text-muted-foreground leading-snug",children:"Allow others to see what stories you've read recently on your profile page"})]})]})}),r.jsx(q,{control:x.control,name:"showBookmarks",render:({field:e})=>r.jsxs(U,{className:"flex flex-row items-start space-x-3 space-y-0 bg-muted/40 rounded-md p-3",children:[r.jsx(M,{children:r.jsx(de,{checked:e.value,onCheckedChange:e.onChange})}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(K,{className:"font-medium",children:"Show Bookmarks"}),r.jsx(I,{className:"text-sm text-muted-foreground leading-snug",children:"Allow others to see your bookmarked stories on your profile page"})]})]})}),r.jsx(q,{control:x.control,name:"allowMentions",render:({field:e})=>r.jsxs(U,{className:"flex flex-row items-start space-x-3 space-y-0 bg-muted/40 rounded-md p-3",children:[r.jsx(M,{children:r.jsx(de,{checked:e.value,onCheckedChange:e.onChange})}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(K,{className:"font-medium",children:"Allow @Mentions"}),r.jsx(I,{className:"text-sm text-muted-foreground leading-snug",children:"Allow other users to mention you in comments using @username"})]})]})})]})]})})})}),r.jsxs(B,{className:"border-t px-6 py-4 flex justify-between",children:[r.jsxs("div",{className:"text-sm text-muted-foreground",children:["Last updated: ",(new Date).toLocaleDateString()]}),r.jsxs(E,{type:"submit",form:"visibility-form",disabled:x.formState.isSubmitting,className:"flex items-center",children:[x.formState.isSubmitting?r.jsx(V,{className:"mr-2 h-4 w-4 animate-spin"}):r.jsx(Q,{className:"mr-2 h-4 w-4"}),r.jsx("span",{children:"Save Visibility Settings"})]})]})]})})]})})}export{Ge as default};
