import{j as e}from"./ui-XowJfzQ7.js";import{r as s,L as r}from"./router-ft_y90OU.js";import{a,c as i,C as n,e as o,V as t,h as l,n as d,f as c,m,g as h,W as x,I as u,B as j,X as p}from"./index-CaZ-hcXF.js";import"./vendor-BbHwBAXo.js";import"./charts-DEf8bB7g.js";import"./utils-SDRWPbZe.js";import"./animations-yM4Nun4l.js";import"./forms-BLyiBPJV.js";function g({limit:u=5,preferredThemes:j=[],showHeading:p=!0,showEmptyMessage:g=!0}){const{toast:y}=a(),{data:f,isLoading:N,isError:v,error:b}=i({queryKey:["/api/recommendations/personalized",u,...j],enabled:!0,retry:2,staleTime:3e5});s.useEffect(()=>{v&&y({title:"Error loading recommendations",description:b instanceof Error?b.message:"Unknown error occurred",variant:"destructive"})},[v,b,y]);const w=()=>{x.invalidateQueries({queryKey:["/api/recommendations/personalized"]}),y({title:"Refreshing recommendations",description:"Finding new horror stories tailored to your interests..."})};return N?e.jsxs("div",{className:"space-y-4",children:[p&&e.jsx("h2",{className:"text-2xl font-bold text-primary mb-4",children:"Recommendations For You"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Array(u).fill(0).map((s,r)=>e.jsxs(n,{className:"overflow-hidden",children:[e.jsx(o,{className:"pb-2",children:e.jsx(t,{className:"h-6 w-3/4"})}),e.jsxs(l,{children:[e.jsx(t,{className:"h-4 w-full mb-2"}),e.jsx(t,{className:"h-4 w-5/6 mb-2"}),e.jsx(t,{className:"h-4 w-4/6"})]}),e.jsx(d,{children:e.jsx(t,{className:"h-4 w-24"})})]},r))})]}):f?.recommendations&&0!==f.recommendations.length?e.jsxs("div",{className:"space-y-4",children:[p&&e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-primary",children:"Recommendations For You"}),e.jsx("button",{onClick:w,className:"px-3 py-1 text-sm bg-secondary text-secondary-foreground rounded-md hover:bg-secondary/80 transition-colors",children:"Refresh"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:f.recommendations.map(s=>e.jsx(r,{href:`/story/${s.slug}`,children:e.jsx("a",{className:"block h-full",children:e.jsxs(n,{className:"h-full overflow-hidden hover:shadow-md transition-shadow cursor-pointer",children:[e.jsxs(o,{className:"pb-2",children:[e.jsx(c,{className:"line-clamp-2",children:s.title}),s.themeCategory&&e.jsx(m,{variant:"outline",className:"bg-secondary/10 text-secondary-foreground w-fit",children:s.themeCategory})]}),e.jsx(l,{children:e.jsx(h,{className:"line-clamp-3",children:s.excerpt||"Dive into this horror tale..."})}),e.jsxs(d,{className:"flex justify-between text-sm text-muted-foreground",children:[e.jsx("span",{children:s.createdAt?new Date(s.createdAt).toLocaleDateString():""}),s.readingTimeMinutes&&e.jsxs("span",{children:[s.readingTimeMinutes," min read"]})]})]})})},s.id))}),f.meta.userPreferences&&e.jsx("p",{className:"text-sm text-muted-foreground mt-4",children:"Recommendations based on your preferred themes and reading history."})]}):g?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-primary mb-4",children:"No Recommendations Yet"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"As you read and interact with stories, we'll learn your preferences and suggest horror tales you might enjoy."}),e.jsx("button",{onClick:w,className:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors",children:"Browse Horror Stories"})]}):null}function y(){const[r,a]=s.useState(""),[i,t]=s.useState([]),[d,x]=s.useState(5),y=()=>{r&&!i.includes(r)&&(t([...i,r]),a(""))};return e.jsxs("div",{className:"container mx-auto py-8 px-4",children:[e.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Personalized Horror Recommendations"}),e.jsx("p",{className:"text-muted-foreground mb-8",children:"Discover stories tailored to your interests and reading history."}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-12",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(n,{children:[e.jsxs(o,{children:[e.jsx(c,{children:"Customize Your Feed"}),e.jsx(h,{children:"Add themes you're interested in to get more relevant horror stories."})]}),e.jsx(l,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{placeholder:"Enter a theme (e.g., 'paranormal')",value:r,onChange:e=>a(e.target.value),onKeyDown:e=>{"Enter"===e.key&&y()}}),e.jsx(j,{onClick:y,children:"Add"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:i.map(s=>e.jsxs(m,{variant:"secondary",className:"flex items-center gap-1",children:[s,e.jsx("button",{onClick:()=>{return e=s,void t(i.filter(s=>s!==e));var e},className:"ml-1",children:e.jsx(p,{size:14})})]},s))}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"limit",className:"text-sm font-medium",children:"Number of stories to show:"}),e.jsx(u,{id:"limit",type:"number",min:1,max:12,value:d,onChange:e=>x(parseInt(e.target.value)||5)})]})]})})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsx(g,{limit:d,preferredThemes:i})})]}),e.jsxs("div",{className:"rounded-lg bg-card p-6 border",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"How Personalization Works"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{children:"Our enhanced recommendation engine delivers personalized horror stories based on multiple factors:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Reading History:"})," We analyze stories you've read to understand your preferences"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Likes & Bookmarks:"})," Stories you've liked or saved help us learn your taste"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Theme Preferences:"}),' Add specific themes you enjoy (like "paranormal" or "psychological")']}),e.jsxs("li",{children:[e.jsx("strong",{children:"Collaborative Filtering:"})," Recommendations based on similar readers' preferences"]})]}),e.jsx("p",{className:"text-muted-foreground",children:"The more you interact with stories, the better your recommendations will become. Our system continuously learns and adapts to provide the most relevant and engaging horror content."})]})]})]})}export{y as default};
