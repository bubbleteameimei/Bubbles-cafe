import{j as e}from"./ui-XowJfzQ7.js";import{q as s,u as t,b as a,c as i,d as n,L as d,aV as l,aX as c,C as r,e as x,f as m,b6 as o,h as j,ba as h,l as u,b5 as f,Q as p,g as N,S as g,B as y}from"./index-CaZ-hcXF.js";import{d as v}from"./router-ft_y90OU.js";import{a as b}from"./api-CyihTzeF.js";import{A as w}from"./activity-timeline-QGB55YTh.js";import{A as k}from"./activity-DRdt7PF2.js";import{a as A}from"./utils-SDRWPbZe.js";import"./vendor-BbHwBAXo.js";import"./charts-DEf8bB7g.js";import"./animations-yM4Nun4l.js";import"./forms-BLyiBPJV.js";import"./user-plus-Bwzf3kyX.js";const L=s("ArrowDownUp",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"m21 8-4-4-4 4",key:"1c9v7m"}],["path",{d:"M17 4v16",key:"7dpous"}]]);function S(){const{user:s}=t(),S=s,q=a();if(!S?.isAdmin)return e.jsx(v,{to:"/"});const{data:D,isLoading:F,error:M}=i({queryKey:["/api/admin/analytics"]}),{data:R=[],isLoading:T}=i({queryKey:["/api/admin/notifications"]}),{data:V=[],isLoading:K}=i({queryKey:["/api/admin/activity"]}),P=n({mutationFn:async e=>{await b("POST",`/api/admin/notifications/${e}/read`)},onSuccess:()=>{q.invalidateQueries({queryKey:["/api/admin/notifications"]})}});return F||T||K?e.jsxs("div",{className:"container mx-auto px-4 py-8 flex flex-col items-center justify-center min-h-[60vh]",children:[e.jsx(d,{className:"h-8 w-8 animate-spin mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading analytics data..."})]}):M?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx(l,{variant:"destructive",children:e.jsx(c,{children:"Failed to load analytics data. Please try again later."})})}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsx("h1",{className:"text-4xl font-bold",children:"Analytics Dashboard"})}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3 mb-8",children:[e.jsxs(r,{children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium",children:"Total Views"}),e.jsx(o,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-2xl font-bold",children:D?.totalViews.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total page views across all stories"})]})]}),e.jsxs(r,{children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium",children:"Unique Visitors"}),e.jsx(h,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-2xl font-bold",children:D?.uniqueVisitors.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Distinct readers on the platform"})]})]}),e.jsxs(r,{children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium",children:"Average Read Time"}),e.jsx(u,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(j,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[D?.avgReadTime.toFixed(1)," min"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Average time spent reading stories"})]})]}),e.jsxs(r,{children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium",children:"Bounce Rate"}),e.jsx(L,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(j,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[(D?.bounceRate||0).toFixed(1),"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Percentage of single-page sessions"})]})]}),e.jsxs(r,{className:"md:col-span-2",children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium",children:"Device Distribution"}),e.jsx(f,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(j,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Desktop"}),e.jsxs("div",{className:"text-2xl font-bold",children:[(100*(D?.deviceStats.desktop||0)).toFixed(1),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Mobile"}),e.jsxs("div",{className:"text-2xl font-bold",children:[(100*(D?.deviceStats.mobile||0)).toFixed(1),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Tablet"}),e.jsxs("div",{className:"text-2xl font-bold",children:[(100*(D?.deviceStats.tablet||0)).toFixed(1),"%"]})]})]})})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 mb-8",children:[e.jsxs(r,{children:[e.jsxs(x,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{children:"Notifications"}),e.jsx(p,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(N,{children:"Recent system notifications and alerts"})]}),e.jsx(j,{children:e.jsx(g,{className:"h-[300px] w-full",children:0===R.length?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No new notifications"}):e.jsx("div",{className:"space-y-4",children:R.map(s=>e.jsxs("div",{className:"flex items-start justify-between gap-4 p-2 rounded-lg bg-muted/50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm",children:s.message}),e.jsx("p",{className:"text-xs text-muted-foreground",children:A(new Date(s.createdAt),"MMM dd, yyyy HH:mm")})]}),e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>P.mutate(s.id),disabled:P.isPending,children:"Mark as read"})]},s.id))})})})]}),e.jsxs(r,{children:[e.jsxs(x,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{children:"Activity Log"}),e.jsx(k,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(N,{children:"Recent admin activities and actions"})]}),e.jsx(j,{children:e.jsx(g,{className:"h-[300px] w-full",children:0===V.length?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No activity logs found"}):e.jsx(w,{activities:V,className:"pb-4"})})})]})]})]})}export{S as default};
